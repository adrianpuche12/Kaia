# Arquitectura y TecnologÃ­as del Proyecto Kaia

## ğŸ—ï¸ Arquitectura General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KAIA ARCHITECTURE                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND      â”‚    â”‚    BACKEND      â”‚    â”‚   DATABASE      â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ React Native    â”‚â—„â”€â”€â–ºâ”‚ Node.js         â”‚â—„â”€â”€â–ºâ”‚ SQLite          â”‚
â”‚ + Expo          â”‚    â”‚ + Express       â”‚    â”‚ + Prisma ORM    â”‚
â”‚ + TypeScript    â”‚    â”‚ + TypeScript    â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   VOICE LAYER   â”‚    â”‚   API LAYER     â”‚    â”‚   DATA MODELS   â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ Web Speech    â”‚    â”‚ â€¢ REST APIs     â”‚    â”‚ â€¢ User          â”‚
â”‚ â€¢ RN Voice      â”‚    â”‚ â€¢ Authenticationâ”‚    â”‚ â€¢ Event         â”‚
â”‚ â€¢ NLP Service   â”‚    â”‚ â€¢ Event CRUD    â”‚    â”‚ â€¢ Reminder      â”‚
â”‚ â€¢ TTS Enhanced  â”‚    â”‚ â€¢ Voice Sessionsâ”‚    â”‚ â€¢ VoiceSession  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“± Frontend Stack

### Core Technologies
- **React Native 0.74+**: Framework multiplataforma
- **Expo SDK 51+**: Herramientas de desarrollo y build
- **TypeScript**: Tipado estÃ¡tico
- **React Navigation**: NavegaciÃ³n entre pantallas

### Voice & AI Services
```typescript
// Unified Voice Architecture
UnifiedVoiceService
â”œâ”€â”€ WebVoiceService (Web Speech API)
â”‚   â”œâ”€â”€ SpeechRecognition
â”‚   â””â”€â”€ SpeechSynthesis
â””â”€â”€ VoiceService (React Native Voice)
    â”œâ”€â”€ @react-native-voice/voice
    â””â”€â”€ expo-speech

// NLP Processing
NLPService
â”œâ”€â”€ Intent Detection (6 tipos)
â”œâ”€â”€ Entity Extraction (5 categorÃ­as)
â”œâ”€â”€ Confidence Scoring
â””â”€â”€ Response Generation
```

### Key Libraries
```json
{
  "dependencies": {
    "react-native": "0.74.5",
    "expo": "~51.0.28",
    "@react-native-voice/voice": "^3.2.4",
    "expo-speech": "~12.0.2",
    "react-navigation": "^6.x"
  }
}
```

## ğŸ–¥ï¸ Backend Stack

### Core Technologies
- **Node.js 18+**: Runtime de JavaScript
- **Express.js**: Framework web minimalista
- **TypeScript**: Desarrollo tipado
- **Prisma ORM**: Object-Relational Mapping

### API Architecture
```
/api/v1/
â”œâ”€â”€ /auth
â”‚   â”œâ”€â”€ POST /login
â”‚   â”œâ”€â”€ POST /register
â”‚   â””â”€â”€ POST /logout
â”œâ”€â”€ /events
â”‚   â”œâ”€â”€ GET /events
â”‚   â”œâ”€â”€ POST /events
â”‚   â”œâ”€â”€ PUT /events/:id
â”‚   â””â”€â”€ DELETE /events/:id
â”œâ”€â”€ /voice
â”‚   â”œâ”€â”€ POST /voice/sessions
â”‚   â””â”€â”€ GET /voice/analytics
â””â”€â”€ /users
    â”œâ”€â”€ GET /profile
    â””â”€â”€ PUT /profile
```

### Dependencies
```json
{
  "dependencies": {
    "express": "^4.19.2",
    "prisma": "^5.19.1",
    "@prisma/client": "^5.19.1",
    "typescript": "^5.5.4",
    "cors": "^2.8.5",
    "helmet": "^7.1.0"
  }
}
```

## ğŸ—„ï¸ Database Design

### Prisma Schema
```prisma
model User {
  id            String    @id @default(cuid())
  email         String    @unique
  name          String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  events        Event[]
  voiceSessions VoiceSession[]
}

model Event {
  id          String    @id @default(cuid())
  title       String
  description String?
  startTime   DateTime
  endTime     DateTime?
  location    String?
  type        String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  userId      String
  user        User      @relation(fields: [userId], references: [id])
  reminders   Reminder[]
}

model Reminder {
  id        String   @id @default(cuid())
  eventId   String
  type      String   // "email", "push", "sms"
  timing    Int      // minutes before event
  sent      Boolean  @default(false)
  createdAt DateTime @default(now())

  event     Event    @relation(fields: [eventId], references: [id])
}

model VoiceSession {
  id           String   @id @default(cuid())
  userId       String
  transcript   String
  intent       String?
  confidence   Float?
  successful   Boolean  @default(false)
  duration     Int?     // milliseconds
  createdAt    DateTime @default(now())

  user         User     @relation(fields: [userId], references: [id])
}
```

## ğŸ”Š Voice Architecture Deep Dive

### 1. Unified Voice Service
```typescript
class UnifiedVoiceService {
  private currentService: WebVoiceService | VoiceService;

  constructor() {
    // Platform detection
    if (Platform.OS === 'web') {
      this.currentService = webVoiceService;
    } else {
      this.currentService = voiceService;
    }
  }
}
```

### 2. Web Voice Service Features
- **Smart Voice Selection**: Prioriza voces premium/neural espaÃ±olas
- **Natural Speech Processing**: Pausas, Ã©nfasis, nÃºmeros en palabras
- **Adaptive Settings**: ConfiguraciÃ³n por tipo de voz
- **Error Handling**: Manejo robusto de errores del navegador

### 3. NLP Processing Pipeline
```typescript
parseInput(text: string): ParsedIntent {
  // 1. Normalize input
  const normalized = text.toLowerCase().trim();

  // 2. Detect intent
  const intent = this.detectIntent(normalized);

  // 3. Extract entities
  const entities = this.extractEntities(normalized);

  // 4. Calculate confidence
  const confidence = this.calculateConfidence(intent, entities);

  return { intent, entities, confidence };
}
```

## ğŸŒ Platform Compatibility

### Web Browsers
| Browser | Speech Recognition | Speech Synthesis | Status |
|---------|-------------------|------------------|--------|
| Chrome 80+ | âœ… Full Support | âœ… Full Support | âœ… Recommended |
| Edge 80+ | âœ… Full Support | âœ… Full Support | âœ… Recommended |
| Firefox | âŒ Limited | âœ… Basic | ğŸŸ¡ Partial |
| Safari | âŒ No Support | âœ… Basic | ğŸ”´ Limited |

### Mobile Platforms
| Platform | Speech Recognition | Speech Synthesis | Status |
|----------|-------------------|------------------|--------|
| iOS 12+ | âœ… Native Support | âœ… Native Support | âœ… Ready |
| Android 8+ | âœ… Native Support | âœ… Native Support | âœ… Ready |

## ğŸ”„ Development Workflow

### Local Development
```bash
# Terminal 1: Backend
cd backend && npm run dev          # http://localhost:3001

# Terminal 2: Frontend Web
cd mobile && npm run web           # http://localhost:8085

# Terminal 3: Mobile Development
cd mobile && npm start             # Expo DevTools
```

### Build Process
```bash
# Web Build
npm run build:web

# Mobile Builds
npx expo build:android            # Android APK
npx expo build:ios               # iOS Archive
```

## ğŸ“Š Performance Metrics

### Voice Recognition
- **Latency**: <2s para comandos tÃ­picos
- **Accuracy**: 85-90% espaÃ±ol estÃ¡ndar
- **Memory**: ~50MB adicionales en web

### Speech Synthesis
- **Quality**: Voces premium cuando disponibles
- **Latency**: <500ms para iniciar sÃ­ntesis
- **Natural Flow**: Pausas automÃ¡ticas, Ã©nfasis conversacional

### NLP Processing
- **Intent Detection**: 92% precisiÃ³n en comandos claros
- **Entity Extraction**: 85% precisiÃ³n en fechas/horas
- **Response Time**: <100ms procesamiento local

---
*DocumentaciÃ³n tÃ©cnica actualizada: 2024-12-29*